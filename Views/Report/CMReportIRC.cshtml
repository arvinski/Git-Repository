@model AgentDesktop.Models.ReportIRCFilter
@using AgentDesktop.Services
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor

@{
	ViewData["Title"] = "Customer Service - Management Report";
}

<style>
	.dataTables_scroll {
		overflow: auto;
	}

	th, td {
		white-space: nowrap;
	}
</style>

<h2 class="content-heading text-black">Filter Report - Customer Management</h2>

<form asp-controller="Report" asp-action="CMReportIRC" method="post">
	<div class="row items-push">
		<div class="col-lg-3">
			<p class="text-muted">
				Please fill necessary field for filteration.
			</p>

		</div>

		<div class="col-lg-7 offset-lg-1">
			<div class="form-group">
				<label for="re-listing-name">Date Filter</label>
				<div class="input-daterange input-group" data-date-format="dd-M-yyyy" data-week-start="1" data-autoclose="true" data-today-highlight="true">
					<input type="text" class="form-control" asp-for="Date1" placeholder="Start Date" data-week-start="1" data-autoclose="true" data-today-highlight="true" autocomplete="off">
					<div class="input-group-prepend input-group-append">
						<span class="input-group-text font-w600">to</span>
					</div>
					<input type="text" class="form-control" asp-for="Date2" placeholder="End Date" data-week-start="1" data-autoclose="true" data-today-highlight="true" autocomplete="off">
				</div>

			</div>

			<div class="form-group row">
				<div class="col-md-8">
					<label for="ReportType">Report Type</label>
					<select class="form-control form-control" asp-for="ReportType">
						<option value="0">Select report type</option>
						<option value="I">Inquiries</option>
						<option value="R">Requests</option>
						<option value="C">Complaints</option>
					</select>
					<span asp-validation-for="ReportType" class="text-danger"></span>
				</div>
			</div>


			<div class="form-group row">
				<div class="col-md-8">
					<label for="ReportType">Report Type Details</label>
					<select class="form-control form-control" asp-for="ReportTypeDet">
						<option value="0">Select report type details</option>
						<option value="1">Count</option>
						<option value="2">Details</option>
					</select>
					<span asp-validation-for="ReportTypeDet" class="text-danger"></span>
				</div>
			</div>


			<div class="form-group">
				<button type="submit" class="btn btn-alt-primary">Show Report</button>
			</div>

		</div>

	</div>
</form>

<div class="block">
	<div class="block-header block-header-default bg-gray-light">
		<h3 class="block-title text-uppercase">SUMMARY REPORT BY REASON CODES (INQUIRY/REQUEST/COMPLAINT)</h3>

		<div class="block-options">
			<input type="text" id="myInput" hidden>
			<a id="btn" href="#" class="btn btn-sm btn-circle btn-outline-danger mr-5 mb-5" data-placement="top" data-toggle="tooltip" title="Export to Excel">
				<i class="fa fa-file-excel-o"></i>
			</a>
		</div>
	</div>

	<div class="block-content block-content-full">
		<div class="dataTables_scroll">
			@if (ViewBag.ViewTableIRC == "0")
			{
				<table id="ListIRC" class="table table-bordered table-striped table-vcenter js-service-dataTable">
					<thead>
						<tr>
							<th class="d-none d-sm-table-cell">DESCRIPTION</th>
							<th class="d-none d-sm-table-cell">REASON CODE</th>
							<th class="d-none d-sm-table-cell">COUNT</th>
							<th class="d-none d-sm-table-cell">COMPLEX</th>
							<th class="d-none d-sm-table-cell">SIMPLE</th>
							<th class="d-none d-sm-table-cell">RESOLVED</th>
							<th class="d-none d-sm-table-cell">OPEN</th>
							<th class="d-none d-sm-table-cell">Cancelled</th>
							<th class="d-none d-sm-table-cell">Closed</th>
							<th class="d-none d-sm-table-cell">Commitment</th>
							<th class="d-none d-sm-table-cell">Endorse</th>
							<th class="d-none d-sm-table-cell">Resolved</th>

						</tr>
					</thead>

					<tbody>
						@foreach (var cnt in ViewBag.ListReportIRC)
						{
							<tr>
								<td class="d-none d-sm-table-cell">@cnt.reason</td>
								<td class="d-none d-sm-table-cell">@cnt.reasoncode</td>
								<td class="d-none d-sm-table-cell text-danger">@cnt.cnt</td>
								<td class="d-none d-sm-table-cell">@cnt.complex</td>
								<td class="d-none d-sm-table-cell">@cnt.simple</td>
								<td class="d-none d-sm-table-cell">@cnt.resolved</td>
								<td class="d-none d-sm-table-cell">@cnt.open</td>
								<td class="d-none d-sm-table-cell text-primary">@cnt.cancelled</td>
								<td class="d-none d-sm-table-cell text-primary">@cnt.closed</td>
								<td class="d-none d-sm-table-cell text-primary">@cnt.commitment</td>
								<td class="d-none d-sm-table-cell text-primary">@cnt.endorsed</td>
								<td class="d-none d-sm-table-cell text-primary">@cnt.resolved2</td>

							</tr>
						}
					</tbody>
				</table>
			}
			else
			{
				<table id="ListCMActivity" class="table-sm table-bordered table-hover table-vcenter js-cmactivity">
					<thead class="bg-primary-light">
						<tr>
							<th class="d-none d-sm-table-cell font-size-xs">TICKET NO</th>
							<th class="d-none d-sm-table-cell font-size-xs">INBOUND/ OUTBOUND</th>
							<th class="d-none d-sm-table-cell font-size-xs">COMM CHANNEL</th>
							<th class="d-none d-sm-table-cell font-size-xs">DATE RECEIVED</th>
							<th class="d-none d-sm-table-cell font-size-xs">TIME RECEIVED</th>
							<th class="d-none d-sm-table-cell font-size-xs">REASON CODE</th>
							<th class="d-none d-sm-table-cell font-size-xs">CUSTOMER NAME</th>
							<th class="d-none d-sm-table-cell font-size-xs">CARD NO</th>
							<th class="d-none d-sm-table-cell font-size-xs">DESTINATION</th>
							<th class="d-none d-sm-table-cell font-size-xs">TRANS TYPE</th>
							<th class="d-none d-sm-table-cell font-size-xs">ATM TRANS</th>
							<th class="d-none d-sm-table-cell font-size-xs">LOCATION</th>
							<th class="d-none d-sm-table-cell font-size-xs">ATM USED</th>
							<th class="d-none d-sm-table-cell font-size-xs">PAYMENT OF</th>
							<th class="d-none d-sm-table-cell font-size-xs">TERMINAL USED</th>
							<th class="d-none d-sm-table-cell font-size-xs">BILLERNAME</th>
							<th class="d-none d-sm-table-cell font-size-xs">MERCHANT</th>
							<th class="d-none d-sm-table-cell font-size-xs">INTER</th>
							<th class="d-none d-sm-table-cell font-size-xs">BANCNET USED</th>
							<th class="d-none d-sm-table-cell font-size-xs">ONLINE</th>
							<th class="d-none d-sm-table-cell font-size-xs">WEB SITE</th>
							<th class="d-none d-sm-table-cell font-size-xs">REMIT FROM</th>
							<th class="d-none d-sm-table-cell font-size-xs">REMIT CONCERN</th>
							<th class="d-none d-sm-table-cell font-size-xs">AMOUNT</th>
							<th class="d-none d-sm-table-cell font-size-xs">CURRENCY</th>
							<th class="d-none d-sm-table-cell font-size-xs">DATE TRANS</th>
							<th class="d-none d-sm-table-cell font-size-xs">PL STATUS</th>
							<th class="d-none d-sm-table-cell font-size-xs">CARD BLOCKED</th>
							<th class="d-none d-sm-table-cell font-size-xs">ACTIVITY</th>
							<th class="d-none d-sm-table-cell font-size-xs">STATUS</th>
							<th class="d-none d-sm-table-cell font-size-xs">SUB STATUS</th>
							<th class="d-none d-sm-table-cell font-size-xs">CREATED BY</th>
							<th class="d-none d-sm-table-cell font-size-xs">LAST UPDATED BY</th>
							<th class="d-none d-sm-table-cell font-size-xs">ENDORSED TO</th>
							<th class="d-none d-sm-table-cell font-size-xs">ENDORSED FROM</th>
							<th class="d-none d-sm-table-cell font-size-xs">DUE DATE</th>
							<th class="d-none d-sm-table-cell font-size-xs">RESOLVED DATE</th>
							<th class="d-none d-sm-table-cell font-size-xs">NATURE OF COMPLAINT</th>
							<th class="d-none d-sm-table-cell font-size-xs">REFERRED BY</th>
							<th class="d-none d-sm-table-cell font-size-xs">CONTACT PERSON</th>
							<th class="d-none d-sm-table-cell font-size-xs">CLASSIFICATION</th>
							<th class="d-none d-sm-table-cell font-size-xs">TIME OF CALL</th>
							<th class="d-none d-sm-table-cell font-size-xs">LOCAL NUMBER</th>
							<th class="d-none d-sm-table-cell font-size-xs">CARD PRESENT</th>
							<th class="d-none d-sm-table-cell font-size-xs">BRANCH</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var usr in ViewBag.ListReportIRCDetail)
						{
						<tr>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.TicketNo
							</td>

							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.InOutBound
							</td>

							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.CommChannel
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap" data-sort="YYYYMMDD">
								@usr.DateReceived.ToString("dd-MMM-yyyy")
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap" data-sort="YYYYMMDD">
								@usr.DateReceived.ToString("HH:mm:ss")
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.abbreviation
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.CustomerName
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.CardNo
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Destination
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.TransType
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.ATMTrans
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Location
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.ATMUsed
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.PaymentOf
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.TerminalUsed
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.BillerName
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Merchant
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Inter
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.BancnetUsed
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Online
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Website
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.RemitFrom
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.RemitConcern
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Amount
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Currency
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.DateTrans
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.PLStatus
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.CardBlocked
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Activity
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Status
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.SubStatus
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.created_by
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Last_Update
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.EndoredTo
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.EndorsedFrom
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Resolved
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.ResolvedDate
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Remarks
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.ReferedBy
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.ContactPerson
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Tagging
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.CallTime
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.LocalNum
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.CardPresent
							</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">
								@usr.Branch
							</td>

						</tr>
						}
					</tbody>
				</table>
			}

		</div>


		<!-- END Orders Table -->

	</div>
</div>

@section Scripts {

	<script>
		$(document).ready(function () {
			$('#Date1').datepicker({ autoclose: true });

			$('#Date2').datepicker({ autoclose: true });
		});

		$('#ListIRC').on('search.dt', function () {
			var value = $('.dataTables_filter input').val();
			document.getElementById("myInput").value = value; // <-- the value
		});

		$('#ListCMActivity').on('search.dt', function () {
			var value = $('.dataTables_filter input').val();
			document.getElementById("myInput").value = value; // <-- the value
		});

		$(function () {
			$('#btn').click(function (evt) {
				$.ajax({
					type: 'GET',
					url:'@Url.Action("GetReportType", "Report")',
					cache: false,
					data: { myInput: @ViewBag.ViewTableIRC },
					success: function (data) {
						if (data.getdet == "0") {
							window.location = "/Report/ExportIRC/";
						}
						else {
							window.location = "/Report/ExportIRCDetail/";
						}
					}
				});
			});
		});

	</script>
}
