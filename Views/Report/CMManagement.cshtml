@model AgentDesktop.Models.ReportManagement

@{
	ViewData["Title"] = "Customer Service - Management Report";
}

<h2 class="content-heading text-black">Filter Report - Management</h2>

<form asp-controller="Report" asp-action="CMManagement" method="post">
	<div class="row items-push">
		<div class="col-lg-3">
			<p class="text-muted">
				Please fill necessary field for filteration.
			</p>

		</div>


		<div class="col-lg-7 offset-lg-1">
			<div class="form-group">
				<label for="re-listing-name">Date Filter</label>
				<div class="input-daterange input-group" data-date-format="dd-M-yyyy" data-week-start="1" data-autoclose="true" data-today-highlight="true">
					<input type="text" class="form-control" asp-for="Date1" placeholder="Start Date" data-week-start="1" data-autoclose="true" data-today-highlight="true" autocomplete="off">
					<div class="input-group-prepend input-group-append">
						<span class="input-group-text font-w600">to</span>
					</div>
					<input type="text" class="form-control" asp-for="Date2" placeholder="End Date" data-week-start="1" data-autoclose="true" data-today-highlight="true" autocomplete="off">
				</div>

			</div>

			<div class="form-group row">
				<div class="col-md-8">
					<label for="ReportType">Report Type</label>
					<select class="form-control form-control" asp-for="ReportType">
						<option value="0">Select report type</option>
						<option value="1">Activity Logs</option>
						<option value="2">Summary by Reason Code and Comm Channel</option>
						<option value="3">Summary by Reason Code and Status</option>
					</select>
					<span asp-validation-for="ReportType" class="text-danger"></span>
				</div>
			</div>

			<div class="form-group row">
				<div class="col-md-8">
					<label for="re-listing-status">Comm Type</label>
					<select class="form-control form-control" asp-for="CommType">
						<option value="0">Select comm type</option>
						<option value="1">Inbound</option>
						<option value="2">Outbound</option>
					</select>
				</div>
			</div>

			<div class="form-group row">
				<div class="col-md-8">
					<label for="re-listing-status">Agent</label>
					<select class="js-select2 form-control" asp-for="Agent" asp-items="ViewBag.cmbAgent" style="width: 100%;" data-placeholder="Choose Agent">
						<option></option>
					</select>
				</div>
			</div>

			<div class="form-group row">
				<div class="col-md-8">
					<label for="re-listing-status">Comm Channel</label>
					<select class="form-control form-control" asp-for="Channel">
						<option value="0">Select comm channel</option>
						<option value="1">Email</option>
						<option value="2">Fax</option>
						<option value="2">SMS</option>
						<option value="2">Telephone</option>
						<option value="2">Voicemail</option>
						<option value="2">Mail</option>
					</select>
				</div>
			</div>

			<div class="form-group">
				<button type="submit" class="btn btn-alt-primary">Show Report</button>
			</div>

		</div>

	</div>
</form>

<div class="block">
	<div class="block-header block-header-default bg-gray-light">
		@{
			switch (ViewBag.Load)
			{
				case "1":
					<h3 class="block-title text-uppercase">SUMMARY REPORT BY ACTIVITY LOGS</h3>
					break;
				case "2":
					<h3 class="block-title text-uppercase">SUMMARY REPORT BY REASON CODE AND COMMUNICATION CHANNEL</h3>
					break;

				case "3":
					<h3 class="block-title text-uppercase">SUMMARY REPORT BY REASON CODE AND STATUS</h3>
					break;

				default:
					<h3 class="block-title text-uppercase"></h3>
					break;
			}

		}
		<div class="block-options">
			<input type="text" id="myInput" hidden>
			<a id="btn" href="#" class="btn btn-sm btn-circle btn-outline-danger mr-5 mb-5" data-placement="top" data-toggle="tooltip" title="Export to Excel">
				<i class="fa fa-file-excel-o"></i>
			</a>
		</div>
	</div>

	<div class="block-content block-content-full">
		<table id="ListManagement" class="table table-bordered table-striped table-vcenter">
			@{
				switch (ViewBag.Load)
				{
					case "0":
						<thead>
							<tr>
								<th class="d-none d-sm-table-cell">TIME</th>
								<th class="d-none d-sm-table-cell">MON</th>
								<th class="d-none d-sm-table-cell">TUE</th>
								<th class="d-none d-sm-table-cell">WED</th>
								<th class="d-none d-sm-table-cell">THU</th>
								<th class="d-none d-sm-table-cell">FRI</th>
								<th class="d-none d-sm-table-cell">SAT</th>
								<th class="d-none d-sm-table-cell">SUN</th>
							</tr>
						</thead>

						<tbody>
							<tr>
								<td class="d-none d-sm-table-cell">TOTAL</td>
								<td class="d-none d-sm-table-cell">0</td>
								<td class="d-none d-sm-table-cell">0</td>
								<td class="d-none d-sm-table-cell">0</td>
								<td class="d-none d-sm-table-cell">0</td>
								<td class="d-none d-sm-table-cell">0</td>
								<td class="d-none d-sm-table-cell">0</td>
								<td class="d-none d-sm-table-cell">0</td>
							</tr>
						</tbody>

						break;

					case "1":
						<thead>
							<tr>
								<th class="d-none d-sm-table-cell">TIME</th>
								<th class="d-none d-sm-table-cell">MON</th>
								<th class="d-none d-sm-table-cell">TUE</th>
								<th class="d-none d-sm-table-cell">WED</th>
								<th class="d-none d-sm-table-cell">THU</th>
								<th class="d-none d-sm-table-cell">FRI</th>
								<th class="d-none d-sm-table-cell">SAT</th>
								<th class="d-none d-sm-table-cell">SUN</th>
							</tr>
						</thead>

						<tbody>
							@foreach (var usr in ViewBag.ListActivityLogs)
							{
								<tr>
									<td class="d-none d-sm-table-cell">@usr.tyme</td>
									<td class="d-none d-sm-table-cell">@usr.Monday</td>
									<td class="d-none d-sm-table-cell">@usr.Tuesday</td>
									<td class="d-none d-sm-table-cell">@usr.Wednesday</td>
									<td class="d-none d-sm-table-cell">@usr.Thursday</td>
									<td class="d-none d-sm-table-cell">@usr.Friday</td>
									<td class="d-none d-sm-table-cell">@usr.Saturday</td>
									<td class="d-none d-sm-table-cell">@usr.Sunday</td>
								</tr>
							}
						</tbody>

						break;

					case "2":

						<thead>
							<tr>
								<th class="d-none d-sm-table-cell">REASON CODE</th>
								<th class="d-none d-sm-table-cell">COMMUNICATION CHANNEL</th>
								<th class="d-none d-sm-table-cell">INBOUND</th>
								<th class="d-none d-sm-table-cell">INBOUND %</th>
								<th class="d-none d-sm-table-cell">OUTBOUND</th>
								<th class="d-none d-sm-table-cell">OUTBOUND %</th>
								<th class="d-none d-sm-table-cell">TOTAL</th>
								<th class="d-none d-sm-table-cell">TOTAL %</th>
							</tr>
						</thead>

						<tbody>
							@foreach (var usr in ViewBag.ListReasonComm)
							{
								<tr>
									<td class="d-none d-sm-table-cell">@usr.ReasonC</td>
									<td class="d-none d-sm-table-cell">@usr.ComChannel</td>
									<td class="d-none d-sm-table-cell">@usr.Inbound</td>
									<td class="d-none d-sm-table-cell">@usr.inper</td>
									<td class="d-none d-sm-table-cell">@usr.outbound</td>
									<td class="d-none d-sm-table-cell">@usr.outper</td>
									<td class="d-none d-sm-table-cell">@usr.total</td>
									<td class="d-none d-sm-table-cell">@usr.totalper</td>
								</tr>
							}
						</tbody>

						break;

					case "3":

						<thead>
							<tr>
								<th class="d-none d-sm-table-cell">REASON CODE</th>
								<th class="d-none d-sm-table-cell">STATUS</th>
								<th class="d-none d-sm-table-cell">INBOUND</th>
								<th class="d-none d-sm-table-cell">INBOUNT %</th>
								<th class="d-none d-sm-table-cell">OUTBOUND</th>
								<th class="d-none d-sm-table-cell">OUTBOUND %</th>
								<th class="d-none d-sm-table-cell">TOTAL</th>
								<th class="d-none d-sm-table-cell">TOTAL %</th>
							</tr>
						</thead>

						<tbody>
							@foreach (var usr in ViewBag.ListReasonStat)
							{
								<tr>
									<td class="d-none d-sm-table-cell">@usr.ReasonC</td>
									<td class="d-none d-sm-table-cell">@usr.Status</td>
									<td class="d-none d-sm-table-cell">@usr.Inbound</td>
									<td class="d-none d-sm-table-cell">@usr.inper</td>
									<td class="d-none d-sm-table-cell">@usr.outbound</td>
									<td class="d-none d-sm-table-cell">@usr.outper</td>
									<td class="d-none d-sm-table-cell">@usr.total</td>
									<td class="d-none d-sm-table-cell">@usr.totalper</td>
								</tr>
							}
						</tbody>

						break;
				}
			}






		</table>
		<!-- END Orders Table -->

	</div>
</div>

@section Scripts {

	<script>
		$(document).ready(function () {
			$('#Agent').select2({
						static: true
			});

			$('#Date1').datepicker({ autoclose: true });

			$('#Date2').datepicker({ autoclose: true });
		});

		$('#ListManagement').on('search.dt', function () {
			var value = $('.dataTables_filter input').val();
			document.getElementById("myInput").value = value; // <-- the value
		});

		$(function () {
			$('#btn').click(function (evt) {
				$.ajax({
					type: 'GET',
					url:'@Url.Action("GetSearch", "Admin")',
					cache: false,
					data: { myInput: $("#myInput").val() },
					success: function (data) {
						if (data.success) {
							window.location = "/Report/ExportManagement/";
						}
					}
				});
			});
		});

	</script>
}
