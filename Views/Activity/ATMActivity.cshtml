@{
	ViewData["Title"] = "ATM Ops Activity";
}

<style>
	.dataTables_scroll {
		overflow: auto;
	}

	th, td {
		white-space: nowrap;
	}
</style>


<div class="content-heading">
	<div class="float-right">
		<a asp-controller="Activity" asp-action="NewCMEntry" class="btn btn-sm btn-circle btn-outline-secondary mr-5 mb-5" data-placement="left" data-toggle="tooltip" title="New Activity">
			<i class="si si-earphones-alt"></i>
		</a>
		<input type="text" id="myInput" hidden>

		<a id="btn" href="#" class="btn btn-sm btn-circle btn-outline-danger mr-5 mb-5" data-placement="top" data-toggle="tooltip" title="Export to Excel">
			<i class="fa fa-file-excel-o"></i>
		</a>
		<a id="btn_hist" href="#" class="btn btn-sm btn-circle btn-outline-info mr-5 mb-5" data-placement="bottom" data-toggle="tooltip" title="Export with History">
			<i class="fa fa-history"></i>
		</a>

	</div>
	List of Customer Service Activities
</div>


<div class="block">
	<form asp-controller="Activity" asp-action="ATMActivity" method="post">
		<div class="block-header block-header-default">
			<div class="block-title">
				<div class="col-lg-6">

					<div class="input-daterange input-group" data-date-format="mm-dd-yyyy" data-week-start="1" data-autoclose="true" data-today-highlight="true">
						<input type="text" class="form-control" id="dt1" name="dt1" placeholder="Start Date" data-week-start="1" data-autoclose="true" data-today-highlight="true" autocomplete="off">
						<div class="input-group-prepend input-group-append">
							<span class="input-group-text font-w600">to</span>
						</div>
						<input type="text" class="form-control" id="dt2" name="dt2" placeholder="End Date" data-week-start="1" data-autoclose="true" data-today-highlight="true" autocomplete="off">
						<div class="input-group-append">
							<button class="btn btn-success" type="submit" data-toggle="tooltip" title="Search by Date"><i class="fa fa-search"></i></button>
						</div>
					</div>


				</div>
			</div>

			<div class="block-options">
				@*<div class="input-group">
						<input id="card_no" name ="card_no" class="form-control" placeholder="Enter Card Number" autocomplete="off" />
						<div class="input-group-append">
							<button class="btn btn-success" type="submit" data-toggle="tooltip" title="Search by Card Number"><i class="fa fa-search"></i></button>
						</div>
					</div>*@
			</div>
		</div>
	</form>

	<div class="block-content block-content-full">
		<div class="dataTables_scroll">
			<!-- CM Activity Table -->
			<table id="ListCMActivity" class="table-sm table-bordered table-hover table-vcenter js-atmlogs-dataTable">
				<thead class="bg-primary-light">
					<tr>
						<th class="d-none d-sm-table-cell font-size-xs">TICKET NO</th>
						<th class="d-none d-sm-table-cell font-size-xs">INBOUND/OUTBOUND</th>
						<th class="d-none d-sm-table-cell font-size-xs">COMM CHANNEL</th>
						<th class="d-none d-sm-table-cell font-size-xs">DATE RECEIVED</th>
						<th class="d-none d-sm-table-cell font-size-xs">REASON CODE</th>
						<th class="d-none d-sm-table-cell font-size-xs">CUSTOMER NAME</th>
						<th class="d-none d-sm-table-cell font-size-xs">CARD NO</th>
						<th class="d-none d-sm-table-cell font-size-xs">DESTINATION</th>
						<th class="d-none d-sm-table-cell font-size-xs">TRANS TYPE</th>
						<th class="d-none d-sm-table-cell font-size-xs">ATM TRANS</th>
						<th class="d-none d-sm-table-cell font-size-xs">LOCATION</th>
						<th class="d-none d-sm-table-cell font-size-xs">ATM USED</th>
						<th class="d-none d-sm-table-cell font-size-xs">PAYMENT OF</th>
						<th class="d-none d-sm-table-cell font-size-xs">TERMINAL USED</th>
						<th class="d-none d-sm-table-cell font-size-xs">BILLERNAME</th>
						<th class="d-none d-sm-table-cell font-size-xs">MERCHANT</th>
						<th class="d-none d-sm-table-cell font-size-xs">INTER</th>
						<th class="d-none d-sm-table-cell font-size-xs">BANCNET USED</th>
						<th class="d-none d-sm-table-cell font-size-xs">ONLINE</th>
						<th class="d-none d-sm-table-cell font-size-xs">WEB SITE</th>
						<th class="d-none d-sm-table-cell font-size-xs">REMIT FROM</th>
						<th class="d-none d-sm-table-cell font-size-xs">REMIT CONCERN</th>
						<th class="d-none d-sm-table-cell font-size-xs">AMOUNT</th>
						<th class="d-none d-sm-table-cell font-size-xs">DATE TRANS</th>
						<th class="d-none d-sm-table-cell font-size-xs">PL STATUS</th>
						<th class="d-none d-sm-table-cell font-size-xs">CARD BLOCKED</th>
						<th class="d-none d-sm-table-cell font-size-xs">ACTIVITY</th>
						<th class="d-none d-sm-table-cell font-size-xs">STATUS</th>
						<th class="d-none d-sm-table-cell font-size-xs">AGENT</th>
						<th class="d-none d-sm-table-cell font-size-xs">ENDORSED TO</th>
						<th class="d-none d-sm-table-cell font-size-xs">DUE DATE</th>
					</tr>
				</thead>
				<tbody>
					@foreach (var usr in ViewBag.ListATMLog)
					{
						<tr>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap"><a class="font-w600" asp-controller="Activity" asp-action="UpdateCMEntry" asp-route-id=@usr.rid>@usr.TicketNo</a></td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.InOutBound</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.CommChannel</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.DateReceived</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.abbreviation</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.CustomerName</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.CardNo</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Destination</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.TransType</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.ATMTrans</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Location</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.ATMUsed</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.PaymentOf</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.TerminalUsed</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.BillerName</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Merchant</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Inter</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.BancnetUsed</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Online</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Website</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.RemitFrom</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.RemitConcern</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Amount</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.DateTrans</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.PLStatus</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.CardBlocked</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Activity</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Status</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Agent</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.EndoredTo</td>
							<td class="d-none d-sm-table-cell font-size-xs" style="white-space:nowrap">@usr.Resolved</td>
						</tr>
					}
				</tbody>
			</table>
			<!-- END CM Activity Table -->

		</div>

	</div>
</div>

<div class="modal fade" id="modal-container" tabindex="-1" role="dialog" aria-labelledby="modal-container" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-dialog-popout" role="document">
		<div class="modal-content">
		</div>
	</div>
</div>

@section Scripts {

	<script>

        $(document).ready(function () {

            $('#modal-container').on('show.bs.modal', function (event) {
                var button = $(event.relatedTarget); // Button that triggered the modal
                var url = button.attr("href");
                var modal = $(this);
                // note that this will replace the content of modal-content everytime the modal is opened
                modal.find('.modal-content').load(url);
            });

            $('#modal-container').on('hidden.bs.modal', function () {
                // remove the bs.modal data attribute from it
                $(this).removeData('bs.modal');
                // and empty the modal-content element
                $('#modal-container .modal-content').empty();

			});

        });

		$('#ListCMActivity').on('search.dt', function () {
			var value = $('.dataTables_filter input').val();
			document.getElementById("myInput").value = value; // <-- the value
		});

		$(function () {
			$('#btn').click(function (evt) {
				$.ajax({
					type: 'GET',
					url:'@Url.Action("GetSearch", "Admin")',
					cache: false,
					data: { myInput: $("#myInput").val() },
					success: function (data) {
						if (data.success) {
							window.location = "/Activity/ExportCMActivity/0";
						}
					}
				});
			});
		});

		$(function () {
			$('#btn_hist').click(function (evt) {
				$.ajax({
					type: 'GET',
					url:'@Url.Action("GetSearch", "Admin")',
					cache: false,
					data: { myInput: $("#myInput").val() },
					success: function (data) {
						if (data.success) {
							window.location = "/Activity/ExportCMActivity/1";
						}
					}
				});
			});
		});


	</script>

}